import{r as x,j as e,c as j,y as f,a as h,Y as v}from"./app-CJ07xozl.js";import{A as w}from"./AuthenticatedLayout-nQrEwO4F.js";import{T as k,a as _,c as S,d as T}from"./constants-Ckjsl-FG.js";import"./ApplicationLogo-CjNzmj9o.js";import"./transition-RWI9d6OS.js";function N({task:s,isAdmin:t,compact:n=!1}){const[l,i]=x.useState(s.is_timer_running),[c,o]=x.useState(0),[a,m]=x.useState("");x.useEffect(()=>{let d;return l&&(d=setInterval(()=>{o(b=>b+1)},1e3)),()=>clearInterval(d)},[l]);const u=d=>{const b=Math.floor(d/3600),p=Math.floor(d%3600/60),y=d%60;return b>0?`${b.toString().padStart(2,"0")}:${p.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`:`${p.toString().padStart(2,"0")}:${y.toString().padStart(2,"0")}`},r=async()=>{try{const d=await j.post(route("time-entries.start",s.id),{description:a});i(!0),o(0),m("")}catch(d){console.error("Error starting timer:",d)}},g=async()=>{try{const d=await j.post(route("time-entries.stop",s.id));i(!1),o(0),f.reload()}catch(d){console.error("Error stopping timer:",d)}};return n?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Total: ",s.formatted_total_time]}),l&&e.jsxs("span",{className:"text-sm text-blue-600 dark:text-blue-400 font-medium",children:["Running: ",u(c)]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:l?e.jsx("button",{onClick:g,className:"bg-red-500 text-white py-1 px-3 rounded text-xs hover:bg-red-600 transition-colors",children:"Stop"}):e.jsx("button",{onClick:r,className:"bg-green-500 text-white py-1 px-3 rounded text-xs hover:bg-green-600 transition-colors",children:"Start"})})]}):e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Time Tracker"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Total Time Spent: ",s.formatted_total_time]}),l&&e.jsxs("div",{className:"bg-blue-100 dark:bg-blue-900/30 p-3 rounded",children:[e.jsx("p",{className:"text-blue-800 dark:text-blue-200 font-medium",children:"Timer Running"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900 dark:text-blue-100",children:u(c)})]})]}),l?e.jsx("button",{onClick:g,className:"w-full bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600 transition-colors",children:"Stop Timer"}):e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:a,onChange:d=>m(d.target.value),placeholder:"What are you working on?",className:"w-full p-2 border border-gray-300 dark:border-gray-600 rounded-md bg-white dark:bg-gray-700 text-gray-900 dark:text-gray-100",rows:"2"}),e.jsx("button",{onClick:r,className:"w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600 transition-colors",children:"Start Timer"})]})]})}function C({task:s,isAdmin:t,onProgressUpdate:n}){const[l,i]=x.useState(s.progress||0),[c,o]=x.useState(!1),a=async r=>{try{const g=await j.patch(route("task.progress",s.id),{progress:r});i(r),n&&n(r)}catch(g){console.error("Error updating progress:",g)}},m=r=>r>=80?"bg-green-500":r>=50?"bg-yellow-500":r>=20?"bg-orange-500":"bg-red-500",u=r=>r===100?"Completed":r>=80?"Almost Done":r>=50?"In Progress":r>=20?"Started":"Not Started";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Progress"}),t&&e.jsx("button",{onClick:()=>o(!c),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm",children:c?"Cancel":"Edit"})]}),c?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"range",min:"0",max:"100",value:l,onChange:r=>i(parseInt(r.target.value)),className:"flex-1"}),e.jsxs("span",{className:"text-sm font-medium w-12 text-gray-900 dark:text-gray-100",children:[l,"%"]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>a(l),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600",children:"Save"}),e.jsx("button",{onClick:()=>o(!1),className:"bg-gray-500 text-white px-3 py-1 rounded text-sm hover:bg-gray-600",children:"Cancel"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:[l,"%"]}),e.jsx("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:u(l)})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${m(l)} transition-all duration-300`,style:{width:`${l}%`}})}),s.subtasks&&s.subtasks.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-2",children:["Sub-tasks: ",s.subtasks.filter(r=>r.status==="completed").length," / ",s.subtasks.length," completed"]}),e.jsx("div",{className:"space-y-1",children:s.subtasks.map(r=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${r.status==="completed"?"bg-green-500":"bg-gray-300 dark:bg-gray-500"}`}),e.jsx("span",{className:`text-xs ${r.status==="completed"?"line-through text-gray-500 dark:text-gray-400":"text-gray-700 dark:text-gray-300"}`,children:r.name})]},r.id))})]})]})]})}function $({task:s,isAdmin:t}){if(!s.subtasks||s.subtasks.length===0)return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-gray-900 dark:text-gray-100",children:"Sub-tasks"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-sm",children:"No sub-tasks created yet."}),t&&e.jsx(h,{href:route("task.create",{parent_task_id:s.id}),className:"inline-block mt-3 bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition-colors",children:"Add Sub-task"})]});const n=s.subtasks.filter(a=>a.status==="completed").length,l=s.subtasks.length,i=l>0?Math.round(n/l*100):0,c=s.total_subtask_time||0,o=s.formatted_total_subtask_time||"0m";return e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-gray-100",children:"Sub-tasks"}),t&&e.jsx(h,{href:route("task.create",{parent_task_id:s.id}),className:"bg-blue-500 text-white px-3 py-1 rounded text-sm hover:bg-blue-600 transition-colors",children:"Add Sub-task"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:[i,"%"]}),e.jsxs("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:[n," of ",l," completed"]})]}),e.jsx("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:`${i}%`}})})]}),c>0&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:"Total Time on Sub-tasks"}),e.jsxs("span",{className:"text-sm font-bold text-blue-900 dark:text-blue-100",children:["⏱️ ",o]})]})}),e.jsx("div",{className:"space-y-3",children:s.subtasks.map(a=>{var m;return e.jsxs("div",{className:`p-4 rounded-lg border ${a.status==="completed"?"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700":"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-4 h-4 rounded-full border-2 flex items-center justify-center ${a.status==="completed"?"bg-green-500 border-green-500":"border-gray-300 dark:border-gray-500"}`,children:a.status==="completed"&&e.jsx("svg",{className:"w-2 h-2 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-medium ${a.status==="completed"?"line-through text-gray-500 dark:text-gray-400":"text-gray-900 dark:text-gray-100"}`,children:a.name}),e.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[(m=a.assignedUser)==null?void 0:m.name," • ",a.priority]}),a.formatted_total_time&&a.formatted_total_time!=="0m"&&e.jsxs("p",{className:"text-xs text-blue-600 dark:text-blue-400 font-medium mt-1",children:["⏱️ ",a.formatted_total_time," spent"]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a.status==="completed"?"bg-green-100 dark:bg-green-900 text-green-800 dark:text-green-200":a.status==="in_progress"?"bg-yellow-100 dark:bg-yellow-900 text-yellow-800 dark:text-yellow-200":"bg-gray-100 dark:bg-gray-700 text-gray-800 dark:text-gray-200"}`,children:a.status.replace("_"," ")}),e.jsx(h,{href:route("task.show",a.id),className:"text-blue-600 dark:text-blue-400 hover:text-blue-800 dark:hover:text-blue-300 text-sm",children:"View"})]})]}),e.jsx("div",{className:"border-t border-gray-200 dark:border-gray-600 pt-3",children:e.jsx(N,{task:a,isAdmin:t,compact:!0})})]},a.id)})})]})}function M({auth:s,task:t,isAdmin:n}){var l,i,c;return e.jsxs(w,{user:s.user,header:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight",children:`Task "${t.name}"`}),e.jsx(h,{href:route("task.edit",t.id),className:"bg-emerald-500 py-1 px-3 text-white rounded shadow transition-all hover:bg-emerald-600",children:"Edit"})]}),children:[e.jsx(v,{title:`Task "${t.name}"`}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 overflow-hidden shadow-sm sm:rounded-lg",children:[t.image_path&&e.jsx("div",{children:e.jsx("img",{src:t.image_path,alt:"",className:"w-full h-64 object-cover"})}),e.jsxs("div",{className:"p-6 text-gray-900 dark:text-gray-100",children:[e.jsxs("div",{className:"grid gap-1 grid-cols-2 mt-2",children:[e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-bold text-lg",children:"Task ID"}),e.jsx("p",{className:"mt-1",children:t.id})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Task Name"}),e.jsx("p",{className:"mt-1",children:t.name})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Task Status"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:"px-2 py-1 rounded text-white "+k[t.status],children:_[t.status]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Task Priority"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:"px-2 py-1 rounded text-white "+S[t.priority],children:T[t.priority]})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Created By"}),e.jsx("p",{className:"mt-1",children:((l=t.createdBy)==null?void 0:l.name)||"Unknown"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-bold text-lg",children:"Due Date"}),e.jsx("p",{className:"mt-1",children:t.due_date||"Not set"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Create Date"}),e.jsx("p",{className:"mt-1",children:t.created_at})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Updated By"}),e.jsx("p",{className:"mt-1",children:((i=t.updatedBy)==null?void 0:i.name)||"Unknown"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Project"}),e.jsx("p",{className:"mt-1",children:t.project?e.jsx(h,{href:route("project.show",t.project.id),className:"hover:underline",children:t.project.name}):"No project assigned"})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Assigned User"}),e.jsx("p",{className:"mt-1",children:((c=t.assignedUser)==null?void 0:c.name)||"Unassigned"})]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"font-bold text-lg",children:"Task Description"}),e.jsx("p",{className:"mt-1",children:t.description||"No description"})]}),(t.formatted_total_time!=="0m"||t.formatted_total_subtask_time!=="0m")&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 dark:text-blue-100 mb-3",children:"Time Tracking Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.formatted_total_time!=="0m"&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Time on this task"}),e.jsxs("span",{className:"text-sm font-bold text-blue-600 dark:text-blue-400",children:["⏱️ ",t.formatted_total_time]})]}),t.formatted_total_subtask_time!=="0m"&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-700 rounded border border-gray-200 dark:border-gray-600",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Time on sub-tasks"}),e.jsxs("span",{className:"text-sm font-bold text-green-600 dark:text-green-400",children:["⏱️ ",t.formatted_total_subtask_time]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(C,{task:t,isAdmin:n})}),e.jsx("div",{className:"mt-6",children:e.jsx(N,{task:t,isAdmin:n})}),e.jsx("div",{className:"mt-6",children:e.jsx($,{task:t,isAdmin:n})})]})]})})})]})}export{M as default};
